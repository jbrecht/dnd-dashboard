<div class="character-card">
  <div class="loading-overlay" *ngIf="character.isLoading">
    <mat-spinner diameter="50"></mat-spinner>
  </div>
  <div class="card-top">
    <div class="avatar-background">
      <img [src]="character.avatarUrl || 'assets/placeholder.png'" alt="{{ character.name }}">
      <div class="avatar-overlay"></div>
    </div>
    
    <button mat-icon-button class="refresh-btn" (click)="refresh()" aria-label="Refresh character">
      <mat-icon>refresh</mat-icon>
    </button>
    
    <button mat-icon-button class="delete-btn" (click)="delete()" aria-label="Delete character">
      <mat-icon>delete</mat-icon>
    </button>

    <div class="card-header">
      <h2>{{ character.name }}</h2>
      <p class="subtitle">{{ character.race.fullName }}</p>
      <div class="classes-list">
        <div class="class-chip" *ngFor="let cls of character.classes">
          {{ cls.definition.name }}
          <span class="level-badge">{{ cls.level }}</span>
        </div>
      </div>
    </div>

    <div class="card-footer-info">
      <div class="ac-container">
        <div class="ac-label">AC</div>
        <div class="ac-value">
          <mat-icon class="ac-shield">shield</mat-icon>
          <span>{{ character.armorClass }}</span>
        </div>
      </div>
      <div class="hp-container">
        <div class="hp-label">HP</div>
        <div class="hp-values">
          <span class="current">{{ character.hitPoints.current }}</span>
          <span class="separator">/</span>
          <span class="max">{{ character.hitPoints.max }}</span>
        </div>
        <mat-progress-bar mode="determinate" [value]="(character.hitPoints.current / character.hitPoints.max) * 100" class="hp-bar" [class]="hpStatus"></mat-progress-bar>
      </div>
    </div>
  </div>

  <div class="card-bottom">
    <div class="stats-grid">
      <div class="stat-box" *ngFor="let stat of character.stats">
        <div class="stat-name">{{ stat.name }}</div>
        <div class="stat-value">{{ stat.value }}</div>
        <div class="stat-mod" [ngClass]="{'positive': getModifier(stat.value) > 0, 'negative': getModifier(stat.value) < 0}">
          {{ getModifier(stat.value) > 0 ? '+' : '' }}{{ getModifier(stat.value) }}
        </div>
      </div>
    </div>
  </div>
</div>
